{"ast":null,"code":"import _regeneratorRuntime from \"D:/trpo backup/trpo/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/trpo backup/trpo/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport axios from 'axios';\nexport default {\n  name: 'AppHeader',\n  setup: function setup() {\n    var isAuthenticated = ref(false);\n    var userName = ref('');\n    var showUserMenu = ref(false);\n    var router = useRouter();\n    var userInitials = computed(function () {\n      if (!userName.value) return '';\n      return userName.value.split(' ').map(function (name) {\n        return name.charAt(0).toUpperCase();\n      }).join('').substring(0, 2);\n    });\n    var checkAuthStatus = function checkAuthStatus() {\n      var token = localStorage.getItem('token');\n      isAuthenticated.value = !!token;\n      if (isAuthenticated.value) {\n        loadUserProfile();\n      }\n    };\n    var loadUserProfile = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var token, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              token = localStorage.getItem('token');\n              _context.next = 4;\n              return axios.get('http://localhost:3000/api/users/profile', {\n                headers: {\n                  Authorization: \"Bearer \".concat(token)\n                }\n              });\n            case 4:\n              response = _context.sent;\n              userName.value = response.data.name || 'Пользователь';\n              _context.next = 11;\n              break;\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('Ошибка при загрузке профиля:', _context.t0);\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n      return function loadUserProfile() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    var toggleUserMenu = function toggleUserMenu() {\n      showUserMenu.value = !showUserMenu.value;\n    };\n    var logout = function logout() {\n      localStorage.removeItem('token');\n      isAuthenticated.value = false;\n      showUserMenu.value = false;\n      router.push('/');\n    };\n\n    // Закрыть меню при клике вне его\n    var handleClickOutside = function handleClickOutside(event) {\n      var userMenu = document.querySelector('.user-menu');\n      if (userMenu && !userMenu.contains(event.target) && showUserMenu.value) {\n        showUserMenu.value = false;\n      }\n    };\n    onMounted(function () {\n      checkAuthStatus();\n\n      // Проверять статус авторизации при изменении URL\n      router.afterEach(function () {\n        checkAuthStatus();\n      });\n\n      // Добавить обработчик клика для закрытия меню\n      document.addEventListener('click', handleClickOutside);\n    });\n    return {\n      isAuthenticated: isAuthenticated,\n      userName: userName,\n      userInitials: userInitials,\n      showUserMenu: showUserMenu,\n      toggleUserMenu: toggleUserMenu,\n      logout: logout\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","useRouter","axios","name","setup","isAuthenticated","userName","showUserMenu","router","userInitials","value","split","map","charAt","toUpperCase","join","substring","checkAuthStatus","token","localStorage","getItem","loadUserProfile","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","headers","Authorization","concat","sent","data","t0","console","error","stop","apply","arguments","toggleUserMenu","logout","removeItem","push","handleClickOutside","event","userMenu","document","querySelector","contains","target","afterEach","addEventListener"],"sources":["D:\\trpo backup\\trpo\\client\\src\\components\\AppHeader.vue"],"sourcesContent":["<template>\n  <header class=\"app-header\">\n    <div class=\"logo\">\n      <router-link to=\"/\">FitFuel</router-link>\n    </div>\n    \n    <nav class=\"main-nav\">\n      <router-link to=\"/\">Главная</router-link>\n      <router-link to=\"/calculator\">Калькулятор</router-link>\n      <router-link to=\"/articles\">Статьи</router-link>\n      <router-link to=\"/food-diary\" v-if=\"isAuthenticated\">Журнал питания</router-link>\n      <router-link to=\"/water-tracker\" v-if=\"isAuthenticated\">Трекер воды</router-link>\n    </nav>\n    \n    <div class=\"search-box\">\n      <input type=\"text\" placeholder=\"Поиск...\" />\n      <button class=\"search-btn\">Найти</button>\n    </div>\n    \n    <div class=\"auth-section\" v-if=\"!isAuthenticated\">\n      <router-link to=\"/login\" class=\"auth-btn login\">Войти</router-link>\n      <router-link to=\"/register\" class=\"auth-btn register\">Регистрация</router-link>\n    </div>\n    \n    <div class=\"user-section\" v-else>\n      <div class=\"user-menu\" @click=\"toggleUserMenu\">\n        <span class=\"user-name\">{{ userName }}</span>\n        <div class=\"user-avatar\">\n          <span class=\"avatar-placeholder\">{{ userInitials }}</span>\n        </div>\n        <div class=\"dropdown-menu\" v-if=\"showUserMenu\">\n          <router-link to=\"/profile\" class=\"dropdown-item\">Профиль</router-link>\n          <router-link to=\"/food-diary\" class=\"dropdown-item\">Журнал питания</router-link>\n          <router-link to=\"/water-tracker\" class=\"dropdown-item\">Трекер воды</router-link>\n          <div class=\"dropdown-divider\"></div>\n          <button @click=\"logout\" class=\"dropdown-item logout\">Выйти</button>\n        </div>\n      </div>\n    </div>\n  </header>\n</template>\n\n<script>\nimport { ref, computed, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport axios from 'axios';\n\nexport default {\n  name: 'AppHeader',\n  setup() {\n    const isAuthenticated = ref(false);\n    const userName = ref('');\n    const showUserMenu = ref(false);\n    const router = useRouter();\n    \n    const userInitials = computed(() => {\n      if (!userName.value) return '';\n      return userName.value.split(' ')\n        .map(name => name.charAt(0).toUpperCase())\n        .join('')\n        .substring(0, 2);\n    });\n    \n    const checkAuthStatus = () => {\n      const token = localStorage.getItem('token');\n      isAuthenticated.value = !!token;\n      \n      if (isAuthenticated.value) {\n        loadUserProfile();\n      }\n    };\n    \n    const loadUserProfile = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const response = await axios.get('http://localhost:3000/api/users/profile', {\n          headers: { Authorization: `Bearer ${token}` }\n        });\n        \n        userName.value = response.data.name || 'Пользователь';\n      } catch (error) {\n        console.error('Ошибка при загрузке профиля:', error);\n      }\n    };\n    \n    const toggleUserMenu = () => {\n      showUserMenu.value = !showUserMenu.value;\n    };\n    \n    const logout = () => {\n      localStorage.removeItem('token');\n      isAuthenticated.value = false;\n      showUserMenu.value = false;\n      router.push('/');\n    };\n    \n    // Закрыть меню при клике вне его\n    const handleClickOutside = (event) => {\n      const userMenu = document.querySelector('.user-menu');\n      if (userMenu && !userMenu.contains(event.target) && showUserMenu.value) {\n        showUserMenu.value = false;\n      }\n    };\n    \n    onMounted(() => {\n      checkAuthStatus();\n      \n      // Проверять статус авторизации при изменении URL\n      router.afterEach(() => {\n        checkAuthStatus();\n      });\n      \n      // Добавить обработчик клика для закрытия меню\n      document.addEventListener('click', handleClickOutside);\n    });\n    \n    return {\n      isAuthenticated,\n      userName,\n      userInitials,\n      showUserMenu,\n      toggleUserMenu,\n      logout\n    };\n  }\n};\n</script>\n\n<style scoped>\n.app-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 1rem 2rem;\n  background-color: #4CAF50;\n  color: white;\n}\n\n.logo {\n  font-size: 2rem;\n  font-weight: bold;\n  font-family: 'Arial', sans-serif;\n}\n\n.logo a {\n  color: white;\n  text-decoration: none;\n}\n\n.main-nav {\n  display: flex;\n  gap: 2rem;\n}\n\n.main-nav a {\n  color: white;\n  text-decoration: none;\n  font-size: 1.1rem;\n  transition: color 0.3s;\n  padding: 0.5rem 0;\n}\n\n.main-nav a:hover,\n.main-nav a.router-link-active {\n  color: #e0e0e0;\n  border-bottom: 2px solid white;\n}\n\n.search-box {\n  display: flex;\n  gap: 0.5rem;\n}\n\n.search-box input {\n  padding: 0.5rem;\n  border: none;\n  border-radius: 4px;\n  width: 200px;\n}\n\n.search-btn {\n  background-color: #45a049;\n  color: white;\n  border: none;\n  padding: 0.5rem 1rem;\n  border-radius: 4px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.search-btn:hover {\n  background-color: #3d8b40;\n}\n\n.auth-section {\n  display: flex;\n  gap: 1rem;\n}\n\n.auth-btn {\n  padding: 0.5rem 1rem;\n  border-radius: 4px;\n  text-decoration: none;\n  transition: all 0.3s;\n}\n\n.login {\n  color: white;\n  border: 1px solid white;\n}\n\n.register {\n  background-color: white;\n  color: #4CAF50;\n}\n\n.login:hover {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n.register:hover {\n  background-color: #f0f0f0;\n}\n\n.user-section {\n  position: relative;\n}\n\n.user-menu {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  cursor: pointer;\n}\n\n.user-name {\n  color: white;\n  font-weight: 500;\n}\n\n.user-avatar {\n  width: 2.5rem;\n  height: 2.5rem;\n  border-radius: 50%;\n  background-color: white;\n  color: #4CAF50;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: bold;\n}\n\n.dropdown-menu {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  width: 200px;\n  margin-top: 0.5rem;\n  background-color: white;\n  border-radius: 4px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n  z-index: 100;\n}\n\n.dropdown-item {\n  display: block;\n  padding: 0.75rem 1rem;\n  color: #333;\n  text-decoration: none;\n  transition: background-color 0.3s;\n}\n\n.dropdown-item:hover {\n  background-color: #f5f5f5;\n}\n\n.dropdown-divider {\n  height: 1px;\n  background-color: #eee;\n  margin: 0.5rem 0;\n}\n\n.logout {\n  color: #d32f2f;\n  width: 100%;\n  text-align: left;\n  background: none;\n  border: none;\n  cursor: pointer;\n  font-size: 1rem;\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}