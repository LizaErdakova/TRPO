{"ast":null,"code":"import _regeneratorRuntime from \"D:/TRPO/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/TRPO/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport axios from 'axios';\nexport default {\n  name: 'AppHeader',\n  setup: function setup() {\n    var isAuthenticated = ref(false);\n    var userName = ref('');\n    var showUserMenu = ref(false);\n    var router = useRouter();\n    var userInitials = computed(function () {\n      if (!userName.value) return '';\n      return userName.value.split(' ').map(function (name) {\n        return name.charAt(0).toUpperCase();\n      }).join('').substring(0, 2);\n    });\n    var checkAuthStatus = function checkAuthStatus() {\n      var token = localStorage.getItem('token');\n      isAuthenticated.value = !!token;\n      if (isAuthenticated.value) {\n        loadUserProfile();\n      }\n    };\n    var loadUserProfile = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var token, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              token = localStorage.getItem('token');\n              _context.next = 4;\n              return axios.get('http://localhost:3000/api/users/profile', {\n                headers: {\n                  Authorization: \"Bearer \".concat(token)\n                }\n              });\n            case 4:\n              response = _context.sent;\n              userName.value = response.data.name || 'Пользователь';\n              _context.next = 11;\n              break;\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('Ошибка при загрузке профиля:', _context.t0);\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n      return function loadUserProfile() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    var toggleUserMenu = function toggleUserMenu() {\n      showUserMenu.value = !showUserMenu.value;\n    };\n    var logout = function logout() {\n      localStorage.removeItem('token');\n      isAuthenticated.value = false;\n      showUserMenu.value = false;\n      router.push('/');\n    };\n\n    // Закрыть меню при клике вне его\n    var handleClickOutside = function handleClickOutside(event) {\n      var userMenu = document.querySelector('.user-menu');\n      if (userMenu && !userMenu.contains(event.target) && showUserMenu.value) {\n        showUserMenu.value = false;\n      }\n    };\n    onMounted(function () {\n      checkAuthStatus();\n\n      // Проверять статус авторизации при изменении URL\n      router.afterEach(function () {\n        checkAuthStatus();\n      });\n\n      // Добавить обработчик клика для закрытия меню\n      document.addEventListener('click', handleClickOutside);\n    });\n    return {\n      isAuthenticated: isAuthenticated,\n      userName: userName,\n      userInitials: userInitials,\n      showUserMenu: showUserMenu,\n      toggleUserMenu: toggleUserMenu,\n      logout: logout\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","useRouter","axios","name","setup","isAuthenticated","userName","showUserMenu","router","userInitials","value","split","map","charAt","toUpperCase","join","substring","checkAuthStatus","token","localStorage","getItem","loadUserProfile","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","headers","Authorization","concat","sent","data","t0","console","error","stop","apply","arguments","toggleUserMenu","logout","removeItem","push","handleClickOutside","event","userMenu","document","querySelector","contains","target","afterEach","addEventListener"],"sources":["D:\\TRPO\\client\\src\\components\\AppHeader.vue"],"sourcesContent":["<template>\r\n  <header class=\"app-header\">\r\n    <div class=\"logo\">\r\n      <router-link to=\"/\">FitFuel</router-link>\r\n    </div>\r\n    \r\n    <nav class=\"main-nav\">\r\n      <router-link to=\"/\">Главная</router-link>\r\n      <router-link to=\"/calculator\">Калькулятор</router-link>\r\n      <router-link to=\"/articles\">Статьи</router-link>\r\n      <router-link to=\"/food-diary\" v-if=\"isAuthenticated\">Журнал питания</router-link>\r\n    </nav>\r\n    \r\n    <div class=\"search-box\">\r\n      <input type=\"text\" placeholder=\"Поиск...\" />\r\n      <button class=\"search-btn\">Найти</button>\r\n    </div>\r\n    \r\n    <div class=\"auth-section\" v-if=\"!isAuthenticated\">\r\n      <router-link to=\"/login\" class=\"auth-btn login\">Войти</router-link>\r\n      <router-link to=\"/register\" class=\"auth-btn register\">Регистрация</router-link>\r\n    </div>\r\n    \r\n    <div class=\"user-section\" v-else>\r\n      <div class=\"user-menu\" @click=\"toggleUserMenu\">\r\n        <span class=\"user-name\">{{ userName }}</span>\r\n        <div class=\"user-avatar\">\r\n          <span class=\"avatar-placeholder\">{{ userInitials }}</span>\r\n        </div>\r\n        <div class=\"dropdown-menu\" v-if=\"showUserMenu\">\r\n          <router-link to=\"/profile\" class=\"dropdown-item\">Профиль</router-link>\r\n          <router-link to=\"/food-diary\" class=\"dropdown-item\">Журнал питания</router-link>\r\n          <div class=\"dropdown-divider\"></div>\r\n          <button @click=\"logout\" class=\"dropdown-item logout\">Выйти</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </header>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  name: 'AppHeader',\r\n  setup() {\r\n    const isAuthenticated = ref(false);\r\n    const userName = ref('');\r\n    const showUserMenu = ref(false);\r\n    const router = useRouter();\r\n    \r\n    const userInitials = computed(() => {\r\n      if (!userName.value) return '';\r\n      return userName.value.split(' ')\r\n        .map(name => name.charAt(0).toUpperCase())\r\n        .join('')\r\n        .substring(0, 2);\r\n    });\r\n    \r\n    const checkAuthStatus = () => {\r\n      const token = localStorage.getItem('token');\r\n      isAuthenticated.value = !!token;\r\n      \r\n      if (isAuthenticated.value) {\r\n        loadUserProfile();\r\n      }\r\n    };\r\n    \r\n    const loadUserProfile = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const response = await axios.get('http://localhost:3000/api/users/profile', {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        \r\n        userName.value = response.data.name || 'Пользователь';\r\n      } catch (error) {\r\n        console.error('Ошибка при загрузке профиля:', error);\r\n      }\r\n    };\r\n    \r\n    const toggleUserMenu = () => {\r\n      showUserMenu.value = !showUserMenu.value;\r\n    };\r\n    \r\n    const logout = () => {\r\n      localStorage.removeItem('token');\r\n      isAuthenticated.value = false;\r\n      showUserMenu.value = false;\r\n      router.push('/');\r\n    };\r\n    \r\n    // Закрыть меню при клике вне его\r\n    const handleClickOutside = (event) => {\r\n      const userMenu = document.querySelector('.user-menu');\r\n      if (userMenu && !userMenu.contains(event.target) && showUserMenu.value) {\r\n        showUserMenu.value = false;\r\n      }\r\n    };\r\n    \r\n    onMounted(() => {\r\n      checkAuthStatus();\r\n      \r\n      // Проверять статус авторизации при изменении URL\r\n      router.afterEach(() => {\r\n        checkAuthStatus();\r\n      });\r\n      \r\n      // Добавить обработчик клика для закрытия меню\r\n      document.addEventListener('click', handleClickOutside);\r\n    });\r\n    \r\n    return {\r\n      isAuthenticated,\r\n      userName,\r\n      userInitials,\r\n      showUserMenu,\r\n      toggleUserMenu,\r\n      logout\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.app-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 1rem 2rem;\r\n  background-color: #4CAF50;\r\n  color: white;\r\n}\r\n\r\n.logo {\r\n  font-size: 2rem;\r\n  font-weight: bold;\r\n  font-family: 'Arial', sans-serif;\r\n}\r\n\r\n.logo a {\r\n  color: white;\r\n  text-decoration: none;\r\n}\r\n\r\n.main-nav {\r\n  display: flex;\r\n  gap: 2rem;\r\n}\r\n\r\n.main-nav a {\r\n  color: white;\r\n  text-decoration: none;\r\n  font-size: 1.1rem;\r\n  transition: color 0.3s;\r\n  padding: 0.5rem 0;\r\n}\r\n\r\n.main-nav a:hover,\r\n.main-nav a.router-link-active {\r\n  color: #e0e0e0;\r\n  border-bottom: 2px solid white;\r\n}\r\n\r\n.search-box {\r\n  display: flex;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.search-box input {\r\n  padding: 0.5rem;\r\n  border: none;\r\n  border-radius: 4px;\r\n  width: 200px;\r\n}\r\n\r\n.search-btn {\r\n  background-color: #45a049;\r\n  color: white;\r\n  border: none;\r\n  padding: 0.5rem 1rem;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.search-btn:hover {\r\n  background-color: #3d8b40;\r\n}\r\n\r\n.auth-section {\r\n  display: flex;\r\n  gap: 1rem;\r\n}\r\n\r\n.auth-btn {\r\n  padding: 0.5rem 1rem;\r\n  border-radius: 4px;\r\n  text-decoration: none;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.login {\r\n  color: white;\r\n  border: 1px solid white;\r\n}\r\n\r\n.register {\r\n  background-color: white;\r\n  color: #4CAF50;\r\n}\r\n\r\n.login:hover {\r\n  background-color: rgba(255, 255, 255, 0.1);\r\n}\r\n\r\n.register:hover {\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.user-section {\r\n  position: relative;\r\n}\r\n\r\n.user-menu {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  cursor: pointer;\r\n}\r\n\r\n.user-name {\r\n  color: white;\r\n  font-weight: 500;\r\n}\r\n\r\n.user-avatar {\r\n  width: 2.5rem;\r\n  height: 2.5rem;\r\n  border-radius: 50%;\r\n  background-color: white;\r\n  color: #4CAF50;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-weight: bold;\r\n}\r\n\r\n.dropdown-menu {\r\n  position: absolute;\r\n  top: 100%;\r\n  right: 0;\r\n  width: 200px;\r\n  margin-top: 0.5rem;\r\n  background-color: white;\r\n  border-radius: 4px;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n  z-index: 100;\r\n}\r\n\r\n.dropdown-item {\r\n  display: block;\r\n  padding: 0.75rem 1rem;\r\n  color: #333;\r\n  text-decoration: none;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.dropdown-item:hover {\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.dropdown-divider {\r\n  height: 1px;\r\n  background-color: #eee;\r\n  margin: 0.5rem 0;\r\n}\r\n\r\n.logout {\r\n  color: #d32f2f;\r\n  width: 100%;\r\n  text-align: left;\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-size: 1rem;\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}